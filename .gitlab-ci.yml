stages:
  - build

.build: &build
  stage: build
  script:
    - opam list | grep coq
    - make
  cache:
    key: "$CI_JOB_NAME"
    paths:
      - ".*.cache"

      - "src/*.glob"
      - "src/*.vo*"
      - "src/.*.aux"

      - "src/*/*.glob"
      - "src/*/*.vo*"
      - "src/*/.*.aux"

      - "src/*/*/*.glob"
      - "src/*/*/*.vo*"
      - "src/*/*/.*.aux"

      - "src/*/*/*/*.glob"
      - "src/*/*/*/*.vo*"
      - "src/*/*/*/.*.aux"

      - "test/*.glob"
      - "test/*.vo*"
      - "test/.*.aux"

coq-8.12: {<<: *build, image: "skeuchel/coq:8.12"}
coq-8.13: {<<: *build, image: "skeuchel/coq:8.13"}
